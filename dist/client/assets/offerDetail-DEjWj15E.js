import{w as ne}from"./with-props-D-7-ZEca.js";import{t as oe,v as w,a as l,w as re,o as v,L as se}from"./chunk-D4RADZKF-B-WwwmlI.js";import{o as ie}from"./offers-By0UXzQi.js";import{a as H}from"./index-CY92ey1p.js";var U,J;function ae(){return J||(J=1,U=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,r,s;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),o=s.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=o;r--!==0;){var i=s[r];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n}),U}var le=ae();const ce=oe(le);function N(){return N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},N.apply(null,arguments)}function A(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.indexOf(o)!==-1)continue;n[o]=t[o]}return n}function ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function de(t){var e=ue(t,"string");return typeof e=="symbol"?e:e+""}const P={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},fe="https://maps.googleapis.com/maps/api/js";class T{static async load(e,n){var o;const r=e.libraries?e.libraries.split(","):[],s=this.serializeParams(e);this.listeners.push(n),(o=window.google)!=null&&(o=o.maps)!=null&&o.importLibrary?(this.serializedApiParams||(this.loadingStatus=P.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=s,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==s&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const i=["maps",...r];await Promise.all(i.map(a=>google.maps.importLibrary(a)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const o=()=>n||(n=new Promise((r,s)=>{var i;const a=document.createElement("script"),d=new URLSearchParams;for(const[m,u]of Object.entries(e)){const p=m.replace(/[A-Z]/g,f=>"_"+f[0].toLowerCase());d.set(p,String(u))}d.set("loading","async"),d.set("callback","__googleMapsCallback__"),a.async=!0,a.src=fe+"?"+d.toString(),a.nonce=((i=document.querySelector("script[nonce]"))==null?void 0:i.nonce)||"",a.onerror=()=>{this.loadingStatus=P.FAILED,this.notifyLoadingStatusListeners(),s(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=P.LOADED,this.notifyLoadingStatusListeners(),r()},window.gm_authFailure=()=>{this.loadingStatus=P.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=P.LOADING,this.notifyLoadingStatusListeners(),document.head.append(a)}),n);google.maps.importLibrary=r=>o().then(()=>google.maps.importLibrary(r))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}T.loadingStatus=P.NOT_LOADED;T.serializedApiParams=void 0;T.listeners=[];const me=["onLoad","onError","apiKey","version","libraries"],ge=["children"],pe="GMP_visgl_rgmlibrary_v1_default",j=w.createContext(null);function he(){const[t,e]=l.useState({});return{mapInstances:t,addMapInstance:(s,i="default")=>{e(a=>N({},a,{[i]:s}))},removeMapInstance:(s="default")=>{e(i=>A(i,[s].map(de)))},clearMapInstances:()=>{e({})}}}function ve(t){const{onLoad:e,onError:n,apiKey:o,version:r,libraries:s=[]}=t,i=A(t,me),[a,d]=l.useState(T.loadingStatus),[m,u]=l.useReducer((c,h)=>c[h.name]?c:N({},c,{[h.name]:h.value}),{}),p=l.useMemo(()=>s==null?void 0:s.join(","),[s]),f=l.useMemo(()=>JSON.stringify(N({apiKey:o,version:r},i)),[o,r,i]),g=l.useCallback(async c=>{var h;if(m[c])return m[c];if(!((h=google)!=null&&(h=h.maps)!=null&&h.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const E=await window.google.maps.importLibrary(c);return u({name:c,value:E}),E},[m]);return l.useEffect(()=>{(async()=>{try{const c=N({key:o},i);r&&(c.v=r),(p==null?void 0:p.length)>0&&(c.libraries=p),(c.channel===void 0||c.channel<0||c.channel>999)&&delete c.channel,c.solutionChannel===void 0?c.solutionChannel=pe:c.solutionChannel===""&&delete c.solutionChannel,await T.load(c,h=>d(h));for(const h of["core","maps",...s])await g(h);e&&e()}catch(c){n?n(c):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",c)}})()},[o,p,f]),{status:a,loadedLibraries:m,importLibrary:g}}const Ce=t=>{const{children:e}=t,n=A(t,ge),{mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:i}=he(),{status:a,loadedLibraries:d,importLibrary:m}=ve(n),u=l.useMemo(()=>({mapInstances:o,addMapInstance:r,removeMapInstance:s,clearMapInstances:i,status:a,loadedLibraries:d,importLibrary:m}),[o,r,s,i,a,d,m]);return w.createElement(j.Provider,{value:u},e)};function ye(t,e){for(const n of Ee){const o=e[n],r=K[n];l.useEffect(()=>{if(!t||!o)return;const s=google.maps.event.addListener(t,r,i=>{o(xe(r,t,i))});return()=>s.remove()},[t,r,o])}}function xe(t,e,n){const o={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(be.includes(t)){const s=o,i=e.getCenter(),a=e.getZoom(),d=e.getHeading()||0,m=e.getTilt()||0,u=e.getBounds();return(!i||!u||!Number.isFinite(a))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),s.detail={center:(i==null?void 0:i.toJSON())||{lat:0,lng:0},zoom:a||0,heading:d,tilt:m,bounds:(u==null?void 0:u.toJSON())||{north:90,east:180,south:-90,west:-180}},s}else if(we.includes(t)){var r;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const s=o;return s.domEvent=n.domEvent,s.stoppable=!0,s.stop=()=>n.stop(),s.detail={latLng:((r=n.latLng)==null?void 0:r.toJSON())||null,placeId:n.placeId},s}return o}const K={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},be=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],we=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],Ee=Object.keys(K);function G(t,e){const n=l.useRef(void 0);(!n.current||!ce(e,n.current))&&(n.current=e),l.useEffect(t,n.current)}const Le=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function Oe(t,e){const n={},o=Object.keys(e);for(const r of o)Le.has(r)&&(n[r]=e[r]);G(()=>{t&&t.setOptions(n)},[n])}function X(){var t;return((t=l.useContext(j))==null?void 0:t.status)||P.NOT_LOADED}function Me(t,e){const{viewport:n,viewState:o}=e,r=!!n;return l.useLayoutEffect(()=>{if(!t||!o)return;const{latitude:s,longitude:i,bearing:a,pitch:d,zoom:m}=o;t.moveCamera({center:{lat:s,lng:i},heading:a,tilt:d,zoom:m+1})},[t,o]),r}function Se(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function Y(t){return Se(t)?t:t.toJSON()}function Ie(t,e,n){const o=n.center?Y(n.center):null;let r=null,s=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(r=o.lat,s=o.lng);const i=Number.isFinite(n.zoom)?n.zoom:null,a=Number.isFinite(n.heading)?n.heading:null,d=Number.isFinite(n.tilt)?n.tilt:null;l.useLayoutEffect(()=>{if(!t)return;const m={};let u=!1;r!==null&&s!==null&&(e.current.center.lat!==r||e.current.center.lng!==s)&&(m.center={lat:r,lng:s},u=!0),i!==null&&e.current.zoom!==i&&(m.zoom=i,u=!0),a!==null&&e.current.heading!==a&&(m.heading=a,u=!0),d!==null&&e.current.tilt!==d&&(m.tilt=d,u=!0),u&&t.moveCamera(m)})}const ke=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return w.createElement("div",{style:t},w.createElement("h2",null,"Error: AuthFailure"),w.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",w.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function Ne(){const[t,e]=l.useState(null),n=l.useCallback(o=>e(o),[e]);return[t,n]}function $(){return X()===P.LOADED}function Pe(){const[,t]=l.useReducer(e=>e+1,0);return t}function Ae(t,e){const n=t.getCenter(),o=t.getZoom(),r=t.getHeading()||0,s=t.getTilt()||0,i=t.getBounds();(!n||!i||!Number.isFinite(o))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:(n==null?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:r,tilt:s})}function De(t){const e=Pe(),n=l.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return l.useEffect(()=>{if(!t)return;const o=google.maps.event.addListener(t,"bounds_changed",()=>{Ae(t,n),e()});return()=>o.remove()},[t,e]),n}const _e=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],Te=["padding"];class F{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}F.entries={};function je(t,e){const n=$(),[o,r]=l.useState(null),[s,i]=Ne(),a=De(o),{id:d,defaultBounds:m,defaultCenter:u,defaultZoom:p,defaultHeading:f,defaultTilt:g,reuseMaps:c,renderingType:h,colorScheme:E}=t,C=A(t,_e),y=t.zoom!==void 0||t.defaultZoom!==void 0,x=t.center!==void 0||t.defaultCenter!==void 0;!m&&(!y||!x)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!C.center&&u&&(C.center=u),!C.zoom&&Number.isFinite(p)&&(C.zoom=p),!C.heading&&Number.isFinite(f)&&(C.heading=f),!C.tilt&&Number.isFinite(g)&&(C.tilt=g);for(const b of Object.keys(C))C[b]===void 0&&delete C[b];const M=l.useRef(void 0);return l.useEffect(()=>{if(!s||!n)return;const{addMapInstance:b,removeMapInstance:L}=e,{mapId:S}=t,I=`${S||"default"}:${h||"default"}:${E||"LIGHT"}`;let k,O;if(c&&F.has(I)?(O=F.pop(I),k=O.getDiv(),s.appendChild(k),O.setOptions(C),setTimeout(()=>O.setCenter(O.getCenter()),0)):(k=document.createElement("div"),k.style.height="100%",s.appendChild(k),O=new google.maps.Map(k,N({},C,h?{renderingType:h}:{},E?{colorScheme:E}:{}))),r(O),b(O,d),m){const{padding:D}=m,B=A(m,Te);O.fitBounds(B,D)}else(!y||!x)&&O.fitBounds({east:180,west:-180,south:-90,north:90});if(M.current){const{mapId:D,cameraState:B}=M.current;D!==S&&O.setOptions(B)}return()=>{M.current={mapId:S,cameraState:a.current},k.remove(),c?F.push(I,O):google.maps.event.clearInstanceListeners(O),r(null),L(d)}},[s,n,d,t.mapId,t.renderingType,t.colorScheme]),[o,i,a]}const Q=w.createContext(null),ee=t=>{const{children:e,id:n,className:o,style:r}=t,s=l.useContext(j),i=X();if(!s)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[a,d,m]=je(t,s);Ie(a,m,t),ye(a,t),Oe(a,t);const u=Me(a,t),p=!!t.controlled;l.useEffect(()=>{if(a)return u&&a.setOptions({disableDefaultUI:!0}),(u||p)&&a.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{a.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[a,u,p,t.gestureHandling,t.keyboardShortcuts]);const f=t.center?Y(t.center):null;let g=null,c=null;f&&Number.isFinite(f.lat)&&Number.isFinite(f.lng)&&(g=f.lat,c=f.lng);const h=l.useMemo(()=>{var y,x,M,b,L;return{center:{lat:(y=g)!=null?y:0,lng:(x=c)!=null?x:0},zoom:(M=t.zoom)!=null?M:0,heading:(b=t.heading)!=null?b:0,tilt:(L=t.tilt)!=null?L:0}},[g,c,t.zoom,t.heading,t.tilt]);l.useLayoutEffect(()=>{if(!a||!p)return;a.moveCamera(h);const y=a.addListener("bounds_changed",()=>{a.moveCamera(h)});return()=>y.remove()},[a,p,h]);const E=l.useMemo(()=>N({width:"100%",height:"100%",position:"relative",zIndex:u?-1:0},r),[r,u]),C=l.useMemo(()=>({map:a}),[a]);return i===P.AUTH_FAILURE?w.createElement("div",{style:N({position:"relative"},o?{}:E),className:o},w.createElement(ke,null)):w.createElement("div",N({ref:d,"data-testid":"map",style:o?void 0:E,className:o},n?{id:n}:{}),a?w.createElement(Q.Provider,{value:C},e):null)};ee.deckGLViewProps=!0;const W=new Set;function ze(...t){const e=JSON.stringify(t);W.has(e)||(W.add(e),console.error(...t))}const R=(t=null)=>{const e=l.useContext(j),{map:n}=l.useContext(Q)||{};if(e===null)return ze("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=e;return t!==null?o[t]||null:n||o.default||null};function te(t){const e=$(),n=l.useContext(j);return l.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),(n==null?void 0:n.loadedLibraries[t])||null}function _(t,e,n){l.useEffect(()=>{if(!t||!e||!n)return;const o=google.maps.event.addListener(t,e,n);return()=>o.remove()},[t,e,n])}function z(t,e,n){l.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function Z(t,e,n){l.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function Fe(t){return t.content!==void 0}function q(t){return t.nodeType===Node.ELEMENT_NODE}const Re=w.createContext(null),Be={BOTTOM:["50%","100%"]},Ue=({children:t,styles:e,className:n,anchorPoint:o})=>{const[r,s]=o??Be.BOTTOM;let i=`-${r}`,a=`-${s}`;r.trimStart().startsWith("-")&&(i=r.substring(1)),s.trimStart().startsWith("-")&&(a=s.substring(1));const d=`translate(50%, 100%) translate(${i}, ${a})`;return w.createElement("div",{style:{transform:d}},w.createElement("div",{className:n,style:e},t))};function He(t){const[e,n]=l.useState(null),[o,r]=l.useState(null),s=R(),i=te("marker"),{children:a,onClick:d,className:m,onMouseEnter:u,onMouseLeave:p,onDrag:f,onDragStart:g,onDragEnd:c,collisionBehavior:h,clickable:E,draggable:C,position:y,title:x,zIndex:M}=t,b=l.Children.count(a);return l.useEffect(()=>{if(!s||!i)return;const L=new i.AdvancedMarkerElement;L.map=s,n(L);let S=null;return b>0&&(S=document.createElement("div"),S.isCustomMarker=!0,L.content=S,r(S)),()=>{var I;L.map=null,(I=S)==null||I.remove(),n(null),r(null)}},[s,i,b]),l.useEffect(()=>{!(e!=null&&e.content)||!q(e.content)||b>0||(e.content.className=m??"")},[e,m,b]),z(e,"position",y),z(e,"title",x??""),z(e,"zIndex",M),z(e,"collisionBehavior",h),l.useEffect(()=>{e&&(C!==void 0?e.gmpDraggable=C:f||g||c?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,C,f,c,g]),l.useEffect(()=>{if(!e)return;const L=E!==void 0||!!d||!!u||!!p;e.gmpClickable=L,L&&e!=null&&e.content&&q(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,E,d,u,p]),_(e,"click",d),_(e,"drag",f),_(e,"dragstart",g),_(e,"dragend",c),Z(e==null?void 0:e.element,"mouseenter",u),Z(e==null?void 0:e.element,"mouseleave",p),[e,o]}l.forwardRef((t,e)=>{const{children:n,style:o,className:r,anchorPoint:s}=t,[i,a]=He(t),d=l.useMemo(()=>i?{marker:i}:null,[i]);return l.useImperativeHandle(e,()=>i,[i]),a?w.createElement(Re.Provider,{value:d},H.createPortal(w.createElement(Ue,{anchorPoint:s,styles:o,className:r},n),a)):null});function Ge(t,e,n){if(e!=null&&typeof e!="object")throw new Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");const o=t.style;if(n==null){if(e==null)return;for(const r in e)e.hasOwnProperty(r)&&V(o,r,e[r]);return}for(const r in n)n.hasOwnProperty(r)&&(e==null||!e.hasOwnProperty(r))&&(r.indexOf("--")===0?o.setProperty(r,""):r==="float"?o.cssFloat="":o[r]="");if(e!=null)for(const r in e){const s=e[r];e.hasOwnProperty(r)&&n[r]!==s&&V(o,r,s)}}function V(t,e,n){const o=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?o?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":o?t.setProperty(e,n):typeof n=="number"&&n!==0&&!Je(e)?t[e]=n+"px":e==="float"?t.cssFloat=n:t[e]=(""+n).trim()}const $e=new Set(["animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","scale","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth"]);function Je(t){return $e.has(t)}const We=["children","headerContent","style","className","pixelOffset","anchor","shouldFocus","onClose","onCloseClick"],Ze=t=>{const{children:e,headerContent:n,style:o,className:r,pixelOffset:s,anchor:i,shouldFocus:a,onClose:d,onCloseClick:m}=t,u=A(t,We),p=te("maps"),[f,g]=l.useState(null),c=l.useRef(null),h=l.useRef(null);l.useEffect(()=>{if(!p)return;c.current=document.createElement("div"),h.current=document.createElement("div");const y=u;s&&(y.pixelOffset=new google.maps.Size(s[0],s[1])),n&&(y.headerContent=typeof n=="string"?n:h.current);const x=new google.maps.InfoWindow(u);return x.setContent(c.current),g(x),()=>{var M,b;x.setContent(null),(M=c.current)==null||M.remove(),(b=h.current)==null||b.remove(),c.current=null,h.current=null,g(null)}},[p]);const E=l.useRef(null);l.useEffect(()=>{!f||!c.current||(Ge(c.current,o||null,E.current),E.current=o||null,r!==c.current.className&&(c.current.className=r||""))},[f,r,o]),G(()=>{if(!f)return;const y=u;s?y.pixelOffset=new google.maps.Size(s[0],s[1]):y.pixelOffset=null,n?y.headerContent=typeof n=="string"?n:h.current:y.headerContent=null,f.setOptions(u)},[u,s,n]),_(f,"close",d),_(f,"closeclick",m);const C=R();return G(()=>{if(!C||!f||i===null)return;const y=!!i,x={map:C};if(i&&(x.anchor=i,Fe(i)&&i.content instanceof Element)){const b=i.content,L=b==null?void 0:b.getBoundingClientRect();if(L&&b!=null&&b.isCustomMarker){var M;const S=(M=i.content.firstElementChild)==null?void 0:M.firstElementChild,I=S==null?void 0:S.getBoundingClientRect(),k=I.x-L.x+(I.width-L.width)/2,O=I.y-L.y,D=u;D.pixelOffset=new google.maps.Size(s?s[0]+k:k,s?s[1]+O:O),f.setOptions(D)}}return a!==void 0&&(x.shouldFocus=a),f.open(x),()=>{y&&f.set("anchor",null),f.close()}},[f,i,C,a,u,s]),w.createElement(w.Fragment,null,c.current&&H.createPortal(e,c.current),h.current!==null&&H.createPortal(n,h.current))},qe=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function Ve(t){const[e,n]=l.useState(null),o=R(),{onClick:r,onDrag:s,onDragStart:i,onDragEnd:a,onMouseOver:d,onMouseOut:m}=t,u=A(t,qe),{position:p,draggable:f}=u;return l.useEffect(()=>{if(!o){o===void 0&&console.error("<Marker> has to be inside a Map component.");return}const g=new google.maps.Marker(u);return g.setMap(o),n(g),()=>{g.setMap(null),n(null)}},[o]),l.useEffect(()=>{if(!e)return;const g=e,c=google.maps.event;return r&&c.addListener(g,"click",r),s&&c.addListener(g,"drag",s),i&&c.addListener(g,"dragstart",i),a&&c.addListener(g,"dragend",a),d&&c.addListener(g,"mouseover",d),m&&c.addListener(g,"mouseout",m),e.setDraggable(!!f),()=>{c.clearInstanceListeners(g)}},[e,f,r,s,i,a,d,m]),l.useEffect(()=>{e&&u&&e.setOptions(u)},[e,u]),l.useEffect(()=>{f||!p||!e||e.setPosition(p)},[f,p,e]),e}const Ke=l.forwardRef((t,e)=>{const n=Ve(t);return l.useImperativeHandle(e,()=>n,[n]),w.createElement(w.Fragment,null)}),Xe={width:"100%",height:"400px"};function Ye({markers:t,onMarkerClick:e,activeMarker:n,onInfoClose:o}){const r=R();return l.useEffect(()=>{if(!r||t.length===0)return;const s=t.reduce((a,d)=>a+d.position.lat,0)/t.length,i=t.reduce((a,d)=>a+d.position.lng,0)/t.length;r.panTo({lat:s,lng:i})},[r,t]),v.jsxs(v.Fragment,{children:[t.map((s,i)=>v.jsx(Ke,{position:s.position,title:s.title,onClick:()=>e(i)},i)),n!==null&&t[n]&&v.jsx(Ze,{position:t[n].position,onCloseClick:o,children:v.jsx("div",{onClick:()=>window.open(`https://www.google.com/search?tbm=isch&q=${encodeURIComponent(t[n].title+" Jordan")}`,"_blank"),className:"text-sm font-semibold cursor-pointer text-[var(--orange1)]",children:t[n].title})})]})}function Qe({offer:t}){const e=$(),[n,o]=l.useState([]),[r,s]=l.useState({lat:31.95,lng:35.91}),[i,a]=l.useState(null);return l.useEffect(()=>{if(!e||!t||n.length>0)return;const d=new google.maps.Geocoder,u=t.places.map(g=>g.trim()).filter(g=>!g.startsWith("!#")).map(g=>{const c=g.split("-")[0].trim();return c.includes("Jordan")?c:`${c}, Jordan`}).filter(Boolean),p=[];let f=u.length;f!==0&&u.forEach(g=>{d.geocode({address:g},(c,h)=>{if(h==="OK"&&c&&c[0]){const E=c[0].geometry.location.toJSON();p.push({position:E,title:g.split(",")[0]})}if(f--,f===0&&p.length>0){o(p);const E=p.reduce((y,x)=>y+x.position.lat,0)/p.length,C=p.reduce((y,x)=>y+x.position.lng,0)/p.length;s({lat:E,lng:C})}})})},[e,t]),e?v.jsx(ee,{defaultCenter:r,defaultZoom:6,gestureHandling:"greedy",zoomControl:!0,disableDefaultUI:!1,style:Xe,children:v.jsx(Ye,{markers:n,onMarkerClick:a,activeMarker:i,onInfoClose:()=>a(null)})}):v.jsx("div",{className:"text-center p-4",children:"Ładowanie mapy..."})}const rt=ne(function(){const{id:e}=re(),n=ie.find(o=>o.id===Number(e));return n?v.jsxs("main",{className:"bg-white",children:[v.jsxs("div",{className:"relative h-[50vh] flex flex-col justify-center items-center overflow-hidden",children:[v.jsx("img",{src:n.imageUrl,alt:n.title,className:"absolute inset-0 w-full h-full object-cover"}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/40 to-black/70"}),v.jsxs("div",{className:"relative z-10 px-4 max-w-4xl text-center",children:[v.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:n.title}),v.jsx("h2",{className:"text-xl text-white/90",children:n.subtitle})]})]}),v.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-16",children:[v.jsx(se,{to:"/offers",className:"text-blue-600 hover:underline text-sm mb-6 inline-block",children:"← Back to offers"}),v.jsxs("article",{className:"prose prose-lg prose-gray text-justify",children:[v.jsx("p",{children:n.description}),v.jsx("h3",{className:"mt-10 text-xl font-bold",children:"Places to visit"}),v.jsx("ul",{className:"space-y-4 mt-4",children:n.places.map((o,r)=>{const s=o.trim().replace(/^!#/,""),[i,...a]=s.split("-");return v.jsxs("li",{className:"flex items-start gap-3",children:[v.jsx("span",{className:"block mt-1 w-3 h-3 bg-[var(--primary)] rounded-full"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-gray-900",children:i.trim()}),a.length>0&&v.jsx("p",{className:"text-gray-600 text-sm",children:a.join("-").trim()})]})]},r)})})]})]}),v.jsx("div",{className:"w-full h-[400px]",children:v.jsx(Ce,{apiKey:"AIzaSyDM-VwvJzDdncSmuFVyw917oCGuMEAx-pM",children:v.jsx(Qe,{offer:n})})})]}):v.jsx("div",{className:"p-8 text-center",children:"Brak oferty o takim ID."})});export{rt as default};
